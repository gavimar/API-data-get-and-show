"use strict";const inputSearch=document.querySelector("#show_search"),submitButton=document.querySelector("#submit"),ulElement=document.querySelector("#search-list"),ulFavouriteElement=document.querySelector("#favourites-list");inputSearch.addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),document.getElementById("submit").click())}));let showList=null,favourites=readLocalStorage();function connectToApi(){ulElement.innerHTML="",fetch(`https://api.tvmaze.com/search/shows?q=${inputSearch.value}`).then(e=>e.json()).then(e=>{showList=e,renderShows(showList),paintSelected(),console.log(showList)})}function renderShows(e){for(let t of e){const e=document.createElement("li");e.setAttribute("id",`${t.show.id}`),e.setAttribute("class","liElement");let n=document.createTextNode(t.show.name),o=document.createElement("h2");o.appendChild(n),e.appendChild(o),ulElement.appendChild(e);let i=document.createElement("img");null!==t.show.image?(i.src=t.show.image.medium,e.appendChild(i)):(i.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV",e.appendChild(i))}addClickListeners(),paintSelected()}function addClickListeners(){const e=document.querySelectorAll(".liElement");for(let t of e)t.addEventListener("click",saveFavourites),t.addEventListener("click",printSelected)}function saveFavourites(e){e.currentTarget.classList.toggle("selected");const t=e.currentTarget.id,n=getObject(t);favourites.some(e=>e.id===parseInt(t))?alert("ya esta en favoritos"):(favourites.push(n.show),setLocalStorage(favourites),renderFavourites(favourites),console.log(favourites))}function getObject(e){return showList.find(t=>t.show.id===parseInt(e))}function setLocalStorage(e){localStorage.setItem("favourites",JSON.stringify(e))}function readLocalStorage(){let e=JSON.parse(localStorage.getItem("favourites"));return null!==e?e:[]}function renderFavourites(e){ulFavouriteElement.innerHTML="";for(let t of e)if(t){const e=document.createElement("li");e.setAttribute("class","liFavourite"),e.setAttribute("id",`${t.id}`);let n=document.createTextNode(t.name),o=document.createElement("p");o.appendChild(n),e.appendChild(o),ulFavouriteElement.appendChild(e);let i=document.createElement("i");i.setAttribute("class","fa fa-window-close"),i.setAttribute("aria-hidden","true"),e.appendChild(i);let r=document.createElement("img");null!==t.image.medium?(r.src=t.image.medium,e.appendChild(r)):(r.src="https://via.placeholder.com/50x100/ffffff/666666/?text=TV",e.appendChild(r))}addFavouriteListeners()}function addFavouriteListeners(){const e=document.querySelectorAll("i");for(let t of e)t.addEventListener("click",removeFav)}function removeFav(e){const t=e.target.parentElement.getAttribute("id"),n=favourites.find(e=>e.id===parseInt(t));let o=favourites.indexOf(n);favourites.splice(o,1),setLocalStorage(),renderFavourites(favourites)}function favinConsole(){for(let e of favourites)console.log(e.name)}function printSelected(e){const t=e.currentTarget.id,n=showList.find(e=>e.show.id===parseInt(t));console.log(n.show.name)}submitButton.addEventListener("click",connectToApi),renderFavourites(favourites),favinConsole();